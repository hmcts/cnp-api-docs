{"openapi":"3.0.1","info":{"description":"A generic Scheduler application to trigger jobs at set intervals","license":{"name":"MIT","url":"https://opensource.org/licenses/MIT"},"title":"Scheduler Specifications","version":"v0.0.1"},"servers":[{"url":"http://localhost","description":"Generated server url"}],"paths":{"/job/{job-key}":{"delete":{"description":"This will delete the Job from the System as well as any associated Tasks","operationId":"deleteJob","parameters":[{"in":"path","name":"job-key","required":true,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string"}}],"responses":{"200":{"description":"Job Deleted"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Delete Job","tags":["Job"]},"get":{"description":"Returns the details of the selected Job","operationId":"getJobDetails","parameters":[{"in":"path","name":"job-key","required":true,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string"}}],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobDetails"}}},"description":"Found"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Get Job Details","tags":["Job"]},"patch":{"description":"Will update the specified Job with the details you provide (any details you do not provide will remain unchanged)","operationId":"updateJob","parameters":[{"in":"path","name":"job-key","required":true,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIJobPatch"}}},"required":true},"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobDetails"}}},"description":"Job updated successfully."},"400":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InvalidPayloadError"}}},"description":"Invalid Payload"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"422":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/IncorrectPayloadForJobTypeError"}}},"description":"Business Validation Rule"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Updates Job Data","tags":["Job"]}},"/job/{job-key}/disable":{"put":{"description":"Disables the specified Job, allowing it to be automatically executed at time intervals specified in the Jobs Cron Expression. (This is only valid for Scheduled Jobs. I.e ones with a Cron expression)","operationId":"disableJob","parameters":[{"in":"path","name":"job-key","required":true,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string"}}],"responses":{"202":{"description":"Job Disabled"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"422":{"content":{"application/problem+json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/NotAScheduledJobError"},{"$ref":"#/components/schemas/JobAlreadyDisabledError"}]}}},"description":"Business Validation Rule"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Disable Job","tags":["Job"]}},"/job/{job-key}/enable":{"put":{"description":"Enables the specified Job, allowing it to be automatically executed at time intervals specified in the Jobs Cron Expression. (This is only valid for Scheduled Jobs. I.e ones with a Cron expression)","operationId":"enableJob","parameters":[{"in":"path","name":"job-key","required":true,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string"}}],"responses":{"202":{"description":"Job Enabled"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"422":{"content":{"application/problem+json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/NotAScheduledJobError"},{"$ref":"#/components/schemas/JobAlreadyEnabledError"}]}}},"description":"Business Validation Rule"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Enable Job","tags":["Job"]}},"/job/{job-key}/run":{"put":{"description":"Trigger the Job to run immediately (Bypassing any schedules if set, as well as enabled/disabled state).","operationId":"runJob","parameters":[{"in":"path","name":"job-key","required":true,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string"}}],"responses":{"202":{"description":"Job queued to run."},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Run Job","tags":["Job"]}},"/job/{job-key}/status":{"get":{"description":"Returns the latest task for a Job","operationId":"getJobStatus","parameters":[{"in":"path","name":"job-key","required":true,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string"}}],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskDetail"}}},"description":"TaskEntity details found for this Job"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Get the latest task for a Job","tags":["Job"]}},"/job/{job-key}/task/{task-id}":{"get":{"description":"Returns the details of the selected TaskEntity","operationId":"getTaskDetail","parameters":[{"in":"path","name":"job-key","required":true,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string"}},{"in":"path","name":"task-id","required":true,"schema":{"maximum":9223372036854775807,"minimum":1,"type":"integer"}}],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskDetail"}}},"description":"Returns the task details"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Returns task details","tags":["TaskEntity"]}},"/job/{job-key}/task/{task-id}/status":{"put":{"description":"This API will update the task status after execution. This is designed to allow third party systems to inform the scheduler that an asynchronous task has successfully or unsuccessfully executed.","operationId":"updateTaskStatus","parameters":[{"in":"path","name":"job-key","required":true,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string"}},{"in":"path","name":"task-id","required":true,"schema":{"maximum":9223372036854775807,"minimum":1,"type":"integer"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StatusUpdate"}}},"required":true},"responses":{"202":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskDetail"}}},"description":"Successfully updated TaskEntity status"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Update TaskEntity Status","tags":["TaskEntity"]}},"/job/{job-key}/tasks":{"get":{"description":"Returns the tasks for a Job","operationId":"getJobTasks","parameters":[{"in":"path","name":"job-key","required":true,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string"}}],"responses":{"200":{"content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskDetail"}}}},"description":"TaskEntity details found for this Job"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Get all the tasks for a Job","tags":["Job"]}},"/jobs/api":{"post":{"description":"An API Job will send an API call to a third party and validate its response when triggered. This API allows you to create a new API Job.","operationId":"createAPIJob","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIJobDetails"}}},"required":true},"responses":{"201":{"description":"Created"},"400":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InvalidPayloadError"}}},"description":"Invalid Payload"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"409":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/KeyAlreadyInUseError"}}},"description":"Key already in use"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Create a new API Job","tags":["Jobs"]}},"/jobs/search":{"get":{"description":"Returns the details of the found tasks","operationId":"getJobs","parameters":[{"description":"The job to search for on. (If none provided all Jobs will be searched)","in":"query","name":"job_key","required":false,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string","description":"The job to search for on. (If none provided all Jobs will be searched)"}},{"description":"The tags to filter by","in":"query","name":"tag","required":false,"schema":{"type":"string","description":"The tags to filter by"}}],"responses":{"200":{"content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskDetail"}}}},"description":"List of Tasks."},"400":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InvalidPayloadError"}}},"description":"Invalid Parameters"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Searches for a list of tasks","tags":["Jobs"]}},"/tasks/search":{"get":{"description":"Returns the details of the found tasks","operationId":"getTasks","parameters":[{"description":"The date at which we should return any failures from.","in":"query","name":"from_date","required":false,"schema":{"type":"string","description":"The date at which we should return any failures from.","default":"Today's date minus 7 days"}},{"description":"The job to search for. (If none provided all Jobs will be searched)","in":"query","name":"job_key","required":false,"schema":{"pattern":"[A-Z_0-9]{3,50}","type":"string","description":"The job to search for. (If none provided all Jobs will be searched)"}},{"description":"The statuses to filter by","in":"query","name":"status","required":false,"schema":{"type":"string","description":"The statuses to filter by"}}],"responses":{"200":{"content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskDetail"}}}},"description":"List of Tasks."},"400":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InvalidPayloadError"}}},"description":"Invalid Parameters"},"401":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/UnauthorisedError"}}},"description":"Unauthorised"},"404":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/NotFoundError"}}},"description":"Not Found"},"500":{"content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/InternalServerError"}}},"description":"Internal Server Error"}},"summary":"Searches for a list of tasks","tags":["Tasks"]}}},"components":{"schemas":{"APIJobDetails":{"required":["information","key","method","type","url","validations"],"type":"object","properties":{"authentication_default":{"type":"string","description":"If present an authentication token will automatically be added to your API request based on the selected system.","enum":["NONE","JUROR_API_SERVICE","API_JOB_EXECUTION_SERVICE"]},"cron_expression":{"type":"string","description":"The cron expression that should be use to schedule this Job. If none is provided the Job will be unscheduled as such will only run if manually triggered."},"headers":{"type":"object","additionalProperties":{"maxLength":100,"minLength":1,"type":"string","description":"All the headers that should be included when making the API Request"},"description":"All the headers that should be included when making the API Request"},"information":{"$ref":"#/components/schemas/Information"},"key":{"pattern":"[A-Z_0-9]{3,50}","type":"string","description":"The key is the unique identifier that should be assigned to this Job."},"method":{"type":"string","description":"The method to use when making the API request","enum":["POST","GET","PUT","PATCH","DELETE","HEAD","OPTIONS","TRACE"]},"payload":{"type":"string","description":"The payload to include along with the request (Note this should not be present for GET requests)"},"type":{"type":"string","enum":["API","API"]},"url":{"type":"string","description":"The fully quantified url to call when making the API request"},"validations":{"maxItems":250,"minItems":1,"type":"array","description":"A list of validations that should be applied to the response after the API request has been made. If any of these fail the task will fail.","items":{"$ref":"#/components/schemas/APIValidation"}}}},"APIJobPatch":{"minProperties":1,"type":"object","properties":{"authentication_default":{"type":"string","description":"If present an authentication token will automatically be added to your API request based on the selected system.","enum":["NONE","JUROR_API_SERVICE","API_JOB_EXECUTION_SERVICE"]},"cron_expression":{"type":"string","description":"This is the cron expression that will be used to setup automated triggering of this Job"},"headers":{"type":"object","additionalProperties":{"maxLength":100,"minLength":1,"type":"string","description":"All the headers that should be included when making the API Request"},"description":"All the headers that should be included when making the API Request"},"information":{"$ref":"#/components/schemas/Information"},"method":{"type":"string","description":"The method to use when making the API request","enum":["POST","GET","PUT","PATCH","DELETE","HEAD","OPTIONS","TRACE"]},"payload":{"type":"string","description":"The payload to include along with the request (Note this should not be present for GET requests)"},"url":{"type":"string","description":"The fully quantified url to call when making the API request"},"validations":{"maxItems":250,"minItems":1,"type":"array","items":{"oneOf":[{"$ref":"#/components/schemas/JsonPathAPIValidation"},{"$ref":"#/components/schemas/MaxResponseTimeAPIValidation"},{"$ref":"#/components/schemas/StatusCodeAPIValidation"}]}}}},"APIValidation":{"required":["type"],"type":"object","properties":{"type":{"type":"string"}},"description":"A list of validations that should be applied to the response after the API request has been made. If any of these fail the task will fail.","discriminator":{"propertyName":"type"},"oneOf":[{"$ref":"#/components/schemas/JsonPathAPIValidation"},{"$ref":"#/components/schemas/StatusCodeAPIValidation"},{"$ref":"#/components/schemas/MaxResponseTimeAPIValidation"}]},"IncorrectPayloadForJobTypeError":{"required":["code","messages"],"type":"object","properties":{"code":{"type":"string","enum":["INCORRECT_PAYLOAD_FOR_JOB_TYPE"]},"messages":{"type":"array","items":{"type":"string","enum":["The payload you have entered is not valid for this type of Job."]},"enum":["The payload you have entered is not valid for this type of Job."]}}},"Information":{"required":["name"],"type":"object","properties":{"description":{"type":"string"},"name":{"type":"string"},"tags":{"uniqueItems":true,"type":"array","items":{"type":"string"}}},"description":"This section stores information about the job"},"InternalServerError":{"required":["code","messages"],"type":"object","properties":{"code":{"type":"string","enum":["INTERNAL_SERVER_ERROR"]},"messages":{"type":"array","items":{"type":"string","enum":["An internal server error has occurred. Please contact system administrators if this problem persists."]},"enum":["An internal server error has occurred. Please contact system administrators if this problem persists."]}}},"InvalidPayloadError":{"required":["code","messages"],"type":"object","properties":{"code":{"type":"string","enum":["INVALID_PAYLOAD"]},"messages":{"type":"array","items":{"type":"string"}}}},"JobAlreadyDisabledError":{"required":["code","messages"],"type":"object","properties":{"code":{"type":"string","enum":["JOB_ALREADY_DISABLED"]},"messages":{"type":"array","items":{"type":"string","enum":["This Job is already disabled"]},"enum":["This Job is already disabled"]}}},"JobAlreadyEnabledError":{"required":["code","messages"],"type":"object","properties":{"code":{"type":"string","enum":["JOB_ALREADY_ENABLED"]},"messages":{"type":"array","items":{"type":"string","enum":["This Job is already enabled"]},"enum":["This Job is already enabled"]}}},"JobDetails":{"required":["information","key","type"],"type":"object","properties":{"cron_expression":{"type":"string","description":"The cron expression that should be use to schedule this Job. If none is provided the Job will be unscheduled as such will only run if manually triggered."},"information":{"$ref":"#/components/schemas/Information"},"key":{"pattern":"[A-Z_0-9]{3,50}","type":"string","description":"The key is the unique identifier that should be assigned to this Job."},"type":{"type":"string","description":"This is the type of Job the details is representing","enum":["API"]}},"oneOf":[{"$ref":"#/components/schemas/APIJobDetails"}]},"JsonPathAPIValidation":{"required":["expected_response","path"],"type":"object","allOf":[{"$ref":"#/components/schemas/APIValidation"},{"type":"object","properties":{"expected_response":{"type":"string","description":"This is the expected value that the JsonPath should return when evaluated against the API response"},"path":{"type":"string","description":"This is the JSON path that the response payload will be evaluated against."}}}]},"KeyAlreadyInUseError":{"required":["code","messages"],"type":"object","properties":{"code":{"type":"string","enum":["KEY_ALREADY_IN_USE"]},"messages":{"type":"array","items":{"type":"string","enum":["The key you have provided is already in use. Please choice a unique key."]},"enum":["The key you have provided is already in use. Please choice a unique key."]}}},"MaxResponseTimeAPIValidation":{"required":["max_response_time_ms"],"type":"object","allOf":[{"$ref":"#/components/schemas/APIValidation"},{"type":"object","properties":{"max_response_time_ms":{"maximum":30000,"minimum":1,"type":"integer","description":"This is the maximum response time that is allowed before the TaskEntity will fail.","format":"int32"}}}]},"NotAScheduledJobError":{"required":["code","messages"],"type":"object","properties":{"code":{"type":"string","enum":["NOT_A_SCHEDULED_JOB"]},"messages":{"type":"array","items":{"type":"string","enum":["The action you are trying to perform is only valid on Scheduled Jobs."]},"enum":["The action you are trying to perform is only valid on Scheduled Jobs."]}}},"NotFoundError":{"required":["code","messages"],"type":"object","properties":{"code":{"type":"string","enum":["NOT_FOUND"]},"messages":{"type":"array","items":{"type":"string","enum":["The requested resource could not be located."]},"enum":["The requested resource could not be located."]}}},"StatusCodeAPIValidation":{"required":["expected_status_code"],"type":"object","allOf":[{"$ref":"#/components/schemas/APIValidation"},{"type":"object","properties":{"expected_status_code":{"maximum":599,"minimum":100,"type":"integer","description":"The expected status code from the API request. Job will fail if something other than this is returned.","format":"int32"}}}]},"StatusUpdate":{"required":["status"],"type":"object","properties":{"message":{"type":"string","description":"A brief message that can be displayed back to the user to help explain the status change"},"status":{"type":"string","description":"The new status of the task","enum":["PENDING","VALIDATION_PASSED","VALIDATION_FAILED","FAILED_UNEXPECTED_EXCEPTION","SUCCESS","FAILED","INDETERMINATE"]}}},"TaskDetail":{"required":["created_at","job_key","status","task_id"],"type":"object","properties":{"created_at":{"type":"string","format":"date-time"},"job_key":{"pattern":"[A-Z_0-9]{3,50}","type":"string"},"last_updated_at":{"type":"string","format":"date-time"},"message":{"type":"string"},"status":{"type":"string","enum":["PENDING","VALIDATION_PASSED","VALIDATION_FAILED","FAILED_UNEXPECTED_EXCEPTION","SUCCESS","FAILED","INDETERMINATE"]},"task_id":{"maximum":9223372036854775807,"minimum":1,"type":"integer","format":"int32"}}},"UnauthorisedError":{"required":["code","messages"],"type":"object","properties":{"code":{"type":"string","enum":["UNAUTHORISED"]},"messages":{"type":"array","items":{"type":"string","enum":["You are not authorised"]},"enum":["You are not authorised"]}}}}}}
